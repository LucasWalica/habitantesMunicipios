CREATE DATABASE habitantesMunicipios;

CREATE TABLE PERSONA(
    DNI VARCHAR(12) PRIMARY KEY,
    NOMBRE VARCHAR (30) NOT NULL,
    TLFNO VARCHAR(12) NOT NULL,
    CABEZA_FAMILIAR VARCHAR(12),
    EMPADRONAMIENTO INT,
    FOREIGN KEY (CABEZA_FAMILIAR) REFERENCES PERSONA(DNI),
    FOREIGN KEY (EMPADRONAMIENTO) REFERENCES MUNICIPIO(CODIGO)
);



INSERT INTO PERSONA(DNI,NOMBRE, TLFNO, CABEZA_FAMILIAR, EMPADRONAMIENTO) 
VALUES
    ("X7839844K", "Pepito Grillo Garcia",       "666666666",NULL,       1),
    ("J7392938J", "Maria Perez Martinez",       "444444444","X7839844K", 1),
    ("X99999999", "Pedro Grillo Perez",         "654342123","X7839844K", 1),
    ("K21212121", "Manolo Fernandez Martinez",  "543234123",NULL,        2),
    ("K12121212", "Angela Perez Perez",         "542533234","K21212121", 2),
    ("J98989899", "Daniela Fernandez Perez",    "654234546","K21212121", 2),
    ("H44444444", "Miguel Fernandez Perez",     "753414745","K21212121", 2),
    ("L22222222", "Lucrecia Gilguero Mer",      "789979087",NULL,       4),
    ("R33333333", "Mario Gilguero Mer",         "898793793",NULL,       3)


CREATE TABLE VIVIENDA(
    CODIGO INT AUTO_INCREMENT PRIMARY KEY,
    M2 INT NOT NULL,
    CODIGOPOSTAL VARCHAR(5) NOT NULL,
    DIRECCION VARCHAR(30) NOT NULL,
    CODIGO_MUNICIPIO INT,
    DNI_PROPIETARIO VARCHAR(12),
    CONSTRAINT CODIGO_MUNICIPIO FOREIGN KEY(CODIGO_MUNICIPIO) REFERENCES MUNICIPIO(CODIGO),
    CONSTRAINT DNI_PROPIETARIO FOREIGN KEY(DNI_PROPIETARIO) REFERENCES PERSONA(DNI)
);

INSERT INTO VIVIENDA(M2, CODIGOPOSTAL, DIRECCION, CODIGO_MUNICIPIO, DNI_PROPIETARIO)
VALUES 
    (95, "33012", "Calle Mon 20 5A Izquierda", 4,"L22222222"),
    (95 ,"10023", "Gran Via 36 3B Derecha"   , 3,"R33333333"),
    (120,"33013", "El Granjero 2A Derecha"   , 2, "K21212121"),
    (400,"43982", "La monsina 2"             , 1, "X7839844K"),
    (200,"43991", "Esperanto 4 B izquierda",   1,"X7839844K")



CREATE TABLE MUNICIPIO(
    CODIGO INT AUTO_INCREMENT PRIMARY KEY,
    NOMBRE VARCHAR(20) NOT NULL,
    PROVINCIA VARCHAR(20) NOT NULL    
)

INSERT INTO MUNICIPIO(NOMBRE, PROVINCIA)
VALUES 
    ("Oviedo", "Asturias"),
    ("Gijon","Asturias"),
    ("Llanes","Asturias"),
    ("Pilo√±a","Asturias")   

 